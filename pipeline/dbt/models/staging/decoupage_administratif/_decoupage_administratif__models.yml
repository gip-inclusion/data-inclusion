version: 2

models:
  - name: stg_decoupage_administratif__regions
    columns:
      - name: code
        data_tests:
          - unique
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string
      - name: nom
        data_tests:
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string

  - name: stg_decoupage_administratif__departements
    columns:
      - name: code
        data_tests:
          - unique
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string
      - name: nom
        data_tests:
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string
      - name: code_region
        data_tests:
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string

  - name: stg_decoupage_administratif__epcis
    columns:
      - name: code
        data_tests:
          - unique
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string
      - name: nom
        data_tests:
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string

  - name: stg_decoupage_administratif__communes
    columns:
      - name: code
        data_tests:
          - unique
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string
      - name: nom
        data_tests:
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string
      - name: code_departement
        data_tests:
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string
          - relationships:
              to: ref('stg_decoupage_administratif__departements')
              field: code
      - name: code_region
        data_tests:
          - not_null
          - dbt_utils.not_constant
          - dbt_utils.not_empty_string
          - relationships:
              to: ref('stg_decoupage_administratif__regions')
              field: code
      - name: code_epci
        data_tests:
          - relationships:
              to: ref('stg_decoupage_administratif__epcis')
              field: code
      - name: centre
        data_tests:
          - not_null
          - dbt_utils.not_constant
