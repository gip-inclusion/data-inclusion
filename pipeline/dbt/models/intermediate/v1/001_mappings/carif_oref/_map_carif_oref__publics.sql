{{ config(materialized='ephemeral') }}

SELECT
    x.formacode_v14,
    UNNEST(x.publics) AS "public"
FROM (
    VALUES
    ('80001', ARRAY['demandeurs-emploi']),
    ('80003', ARRAY['demandeurs-emploi']),
    ('80004', ARRAY['demandeurs-emploi']),
    ('80006', ARRAY['demandeurs-emploi']),
    ('80007', ARRAY['demandeurs-emploi']),
    ('80009', ARRAY['demandeurs-emploi', 'jeunes']),
    ('80010', ARRAY['beneficiaires-des-minimas-sociaux']),
    ('81013', ARRAY['personnes-en-situation-juridique-specifique']),
    ('81014', ARRAY['actifs']),
    ('81018', ARRAY['femmes']),
    ('81019', NULL),
    ('81020', ARRAY['personnes-en-situation-de-handicap']),
    ('81021', NULL),
    ('81022', ARRAY['personnes-exilees']),
    ('81030', ARRAY['etudiants']),
    ('81031', NULL),
    ('81024', ARRAY['jeunes']),
    ('81032', ARRAY['jeunes']),
    ('81033', ARRAY['jeunes']),
    ('81042', ARRAY['personnes-exilees']),
    ('81043', NULL),
    ('81050', ARRAY['tous-publics']),
    ('81058', NULL),
    ('81059', NULL),
    ('81060', NULL),
    ('81061', NULL),
    ('81062', NULL),
    ('81069', NULL),
    ('81099', NULL),
    ('82004', ARRAY['actifs']),
    ('82009', ARRAY['actifs']),
    ('82010', ARRAY['actifs']),
    ('82012', ARRAY['actifs']),
    ('82015', ARRAY['actifs']),
    ('82016', ARRAY['actifs']),
    ('82017', ARRAY['actifs']),
    ('82018', ARRAY['actifs']),
    ('82019', NULL),
    ('82020', ARRAY['actifs']),
    ('82038', ARRAY['actifs']),
    ('82044', ARRAY['actifs']),
    ('82045', ARRAY['actifs']),
    ('82046', ARRAY['actifs']),
    ('82047', ARRAY['actifs']),
    ('82048', ARRAY['actifs']),
    ('82049', NULL),
    ('82057', ARRAY['actifs']),
    ('82058', ARRAY['actifs']),
    ('82060', ARRAY['actifs']),
    ('82061', ARRAY['actifs']),
    ('82061', ARRAY['personnes-en-situation-de-handicap']),
    ('82062', ARRAY['actifs']),
    ('82063', ARRAY['actifs']),
    ('82064', ARRAY['actifs']),
    ('82066', ARRAY['actifs']),
    ('82067', ARRAY['actifs']),
    ('82068', NULL),
    ('82069', ARRAY['actifs']),
    ('82080', ARRAY['actifs']),
    ('83056', ARRAY['tous-publics']),
    ('81028', ARRAY['personnes-en-situation-de-handicap']),
    ('81027', ARRAY['personnes-en-situation-de-handicap']),
    ('81025', ARRAY['personnes-en-situation-de-handicap']),
    ('81029', ARRAY['personnes-en-situation-de-handicap']),
    ('81026', ARRAY['personnes-en-situation-de-handicap']),
    ('81024', ARRAY['jeunes']),
    ('81033', ARRAY['jeunes']),
    ('81023', ARRAY['personnes-exilees']),
    ('81031', ARRAY['demandeurs-emploi'])
) AS x (formacode_v14, publics)
